strict digraph {
n0 [label="def authenticate_user(...)"];
n1 [label="if not username or not password_"];
n2 [label="return 'Missing credentials'"];
n3 [label="after_if"];
n4 [label="if username not in db_"];
n5 [label="return 'User not found'"];
n6 [label="after_if"];
n7 [label="attempts = db[username].get('attempts', 0)"];
n8 [label="if attempts >= 3_"];
n9 [label="return 'Account locked'"];
n10 [label="after_if"];
n11 [label="if db[username]['password'] != password_"];
n12 [label="db[username]['attempts'] = attempts + 1"];
n13 [label="return 'Invalid password'"];
n14 [label="after_if"];
n15 [label="db[username]['attempts'] = 0"];
n16 [label="return 'Authenticated'"];
n0 -> n1;
n1 -> n2;
n1 -> n3;
n2 -> n3;
n3 -> n4;
n4 -> n5;
n4 -> n6;
n5 -> n6;
n6 -> n7;
n7 -> n8;
n8 -> n9;
n8 -> n10;
n9 -> n10;
n10 -> n11;
n11 -> n12;
n11 -> n14;
n12 -> n13;
n13 -> n14;
n14 -> n15;
n15 -> n16;
}
